import{I as E,S as x}from"./SelectOption-BngCvTbz.js";import{_ as V,x as v,e as d,p as b,t as h,f as s,i as c,F as w,z as y,g as a,j as M,m as f,o as u,w as k,q as U,s as I}from"./app-DHpn0u2P.js";import{c as F}from"./countries-Cj1GR0vB.js";const S={name:"MatchmakerClient",components:{InputText:E,SelectOption:x},data(){return{loading:!0,error:null,debugInfo:null,processing:!1,showAddClientForm:!1,user:null,authorization:null,newClient:{userId:"",isUpdating:!1,name:"",email:"",city:"",state:"",country:"",currentLocation:"",age:"",hairColor:"",bodytype:"",heightFeet:"",heightInches:"",maritalStatus:"",children:"",religion:"",smoker:"",drinker:"",education:"",jobTitle:"",sports:"",hobbies:"",englishLevel:"",languages:"",interests:"",avatar:null},validationErrors:{},clients:[],countries:F,bodyTypes:["Slender","Average","Athletic","Curvy","Big and Beautiful"],maritalStatuses:["Single","Separated","Divorced","Married"],childrenOptions:["0","1","2","3","4","5","6","7","8","9","10"],religions:["Buddhism","Catholic","Christian","Confucianism","Hinduism","Islam","Jainism","Judaism","Shinto","Sikhism","Taoism","Zoroastrianism","Other"],yesNoOptions:["Yes","No"],drinkerOptions:["None","Occasionally","Often"],englishLevels:["Beginner","Intermediate","Proficient"],successMessage:"",preview:null,files:{avatar:null,additional_images:[]}}},methods:{getImageUrl(o){return o?o.startsWith("http")?o:`/storage/${o}`:"/upload/images/profiles/default.png"},async initializeComponent(){var o,r,t,m;try{if(console.log("Initializing component..."),console.log("Full Vuex State:",this.$store.state),!((r=(o=this.$store)==null?void 0:o.state)!=null&&r.auth))throw console.log("Store or auth state is missing"),new Error("Authentication state not found");const e=this.$store.state.auth;if(console.log("Auth State:",e),this.debugInfo={storeExists:!!this.$store,authStateExists:!!e,userExists:!!(e!=null&&e.user),userDetails:e==null?void 0:e.user,token:(t=e==null?void 0:e.authorization)!=null&&t.token?"Exists":"Missing"},!e.authenticated||!e.user||!((m=e.authorization)!=null&&m.token))throw new Error("Please log in to continue");if(e.user.role!=="matchmaker")throw new Error("Access restricted to matchmakers only");this.user=e.user,this.authorization=e.authorization,console.log("User authenticated:",{id:this.user.id,role:this.user.role}),await this.getClient()}catch(e){console.error("Initialization error:",e),this.error=e.message||"An error occurred while loading"}finally{this.loading=!1}},toggleAddClientForm(){this.showAddClientForm=!this.showAddClientForm,this.showAddClientForm||this.resetForm()},onFileChange(o,r){const t=o.target.files[0];r==="avatar"&&(this.files.avatar=t,t?this.preview=URL.createObjectURL(t):this.preview=null)},onMultipleFileChange(o){this.files.additional_images=Array.from(o.target.files)},resetForm(){this.newClient={userId:"",isUpdating:!1,name:"",email:"",city:"",state:"",country:"",currentLocation:"",age:"",hairColor:"",bodytype:"",heightFeet:"",heightInches:"",maritalStatus:"",children:"",religion:"",smoker:"",drinker:"",education:"",jobTitle:"",sports:"",hobbies:"",englishLevel:"",languages:"",interests:"",avatar:null},this.validationErrors={},this.successMessage="",this.preview=null,this.files.avatar=null,this.files.additional_images=[]},async addClient(){var r,t,m,e;if(!this.user||!this.authorization){this.error="Please log in to continue";return}this.processing=!0,this.clearErrors();const o=new FormData;Object.keys(this.newClient).forEach(l=>{l!=="avatar"&&l!=="additional_images"&&this.newClient[l]!==null&&this.newClient[l]!==""&&o.append(l,this.newClient[l])}),this.files.avatar&&o.append("avatar",this.files.avatar),this.files.additional_images.length>0&&this.files.additional_images.forEach((l,n)=>{o.append(`additional_images[${n}]`,l)});try{(await v.post("/api/matchmaker/clients",o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${this.authorization.token}`}})).data.success&&(this.successMessage="Client added successfully",this.resetForm(),await this.getClient(),this.showAddClientForm=!1)}catch(l){console.error("Error adding client:",l),(t=(r=l.response)==null?void 0:r.data)!=null&&t.errors?this.validationErrors=l.response.data.errors:(e=(m=l.response)==null?void 0:m.data)!=null&&e.message?this.validationErrors={general:l.response.data.message}:this.validationErrors={general:"An error occurred while adding the client"}}finally{this.processing=!1}},async getClient(){var o,r,t,m,e,l;if(!((o=this.user)!=null&&o.id)||!((r=this.authorization)!=null&&r.token))throw console.error("Missing required data for getClient:",{userId:(t=this.user)==null?void 0:t.id,hasToken:!!((m=this.authorization)!=null&&m.token)}),new Error("Authentication required");try{console.log("Fetching clients for user:",this.user.id);const n=await v.get(`/api/matchmaker/clients/${this.user.id}`,{headers:{Authorization:`Bearer ${this.authorization.token}`}});console.log("Client response:",n.data),n.data.success?this.clients=n.data.data.map(g=>({...g,user:g.user||{},profile:g.profile||{},thumbnail_image:g.thumbnail_image,additional_images:Array.isArray(g.additional_images)?g.additional_images:JSON.parse(g.additional_images||"[]")})):this.error=n.data.message||"Failed to fetch clients"}catch(n){console.error("getClient error:",n.response||n),this.error=((l=(e=n.response)==null?void 0:e.data)==null?void 0:l.message)||"Error fetching clients"}},async editClient(o){var m,e;const r=this.clients.find(l=>l.id===o);if(!r){alert("Client not found.");return}const t=r.profile||{};this.newClient={userId:r.user_id,isUpdating:!0,name:((m=r.user)==null?void 0:m.name)||"",email:((e=r.user)==null?void 0:e.email)||"",city:r.city||t.city||"",state:r.state||t.state||"",country:r.country||t.country||"",currentLocation:t.currentLocation||r.city||"",age:r.age||t.age||"",hairColor:t.hairColor||"",bodytype:r.body_type||t.bodytype||"",heightFeet:r.height_feet||t.height||"",heightInches:r.height_inches||t.inches||"",maritalStatus:r.marital_status||t.maritalstatus||"",children:(r.children||t.children||0).toString(),religion:r.religion||t.religion||"",smoker:t.smoker?"Yes":"No",drinker:t.drinker||"None",education:t.education||"",jobTitle:t.jobtitle||"",sports:t.sports||"",hobbies:t.hobbies||"",englishLevel:t.english_level||"Intermediate",languages:t.languages||"",interests:r.interests||"",avatar:null},this.preview=this.getImageUrl(r.thumbnail_image),this.validationErrors={},this.successMessage="",this.showAddClientForm=!0},async updateClient(){if(!this.user||!this.authorization){this.error="Please log in to continue";return}this.processing=!0,this.clearErrors();const o=new FormData;Object.keys(this.newClient).forEach(r=>{!["userId","isUpdating","avatar"].includes(r)&&this.newClient[r]!==null&&o.append(r,this.newClient[r])}),this.files.avatar&&o.append("avatar",this.files.avatar),this.files.additional_images.length>0&&this.files.additional_images.forEach((r,t)=>{o.append(`additional_images[${t}]`,r)});try{(await v.post(`/api/matchmaker/clients/${this.newClient.userId}`,o,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${this.authorization.token}`}})).data.success&&(this.successMessage="Client updated successfully",this.resetForm(),await this.getClient(),this.showAddClientForm=!1)}catch(r){console.error("Error updating client:",r),this.handleError(r)}finally{this.processing=!1}},handleError(o){var r,t,m,e;(t=(r=o.response)==null?void 0:r.data)!=null&&t.errors?this.validationErrors=o.response.data.errors:(e=(m=o.response)==null?void 0:m.data)!=null&&e.message?this.validationErrors={general:o.response.data.message}:this.validationErrors={general:"An error occurred"}},clearErrors(){this.validationErrors={},this.error=null}},async created(){console.log("Component created"),this.$store.getters["auth/isInitialized"]||await this.$store.dispatch("auth/initialize"),await this.initializeComponent()},mounted(){console.log("Component mounted"),console.log("Current Vuex State:",this.$store.state)}},p=o=>(U("data-v-190b4678"),o=o(),I(),o),A={class:"max-w-7xl mx-auto p-6 bg-white rounded-sm shadow-xs"},q={key:0,class:"flex justify-center items-center py-8"},L=p(()=>s("div",{class:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"},null,-1)),z=[L],j={key:1,class:"text-red-500 p-4 text-center"},T={key:0,class:"mt-2 text-sm"},O=p(()=>s("p",null,"Debug Info:",-1)),N={class:"bg-gray-100 p-2 mt-1 rounded overflow-auto"},B={key:2},D={class:"flex justify-between items-center mb-6"},P=p(()=>s("h2",{class:"text-2xl font-semibold"},"Matchmaker's Clients",-1)),H={key:0,class:"mb-4 text-green-500"},J={key:1,class:"mb-10"},R={class:"text-xl font-semibold mb-4"},Y={key:0,class:"mb-4"},W={class:"alert alert-danger"},Z={class:"mb-0"},G={class:"mb-4"},K=p(()=>s("label",{class:"block text-gray-700"},[b(" Upload Thumbnail Image "),s("span",{class:"text-red-500"},"*")],-1)),Q=["required"],X={key:0,class:"text-red-500 text-xs italic"},$={key:1,class:"mt-2"},ee=["src"],re={class:"mb-4"},ie=p(()=>s("label",{class:"block text-gray-700"},"Upload Additional Images",-1)),se={key:0,class:"text-red-500 text-xs italic"},te={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ne={class:"flex gap-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},de={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},me={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ce={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},pe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ve={class:"mt-6 flex justify-end"},fe=["disabled"],be={key:2},Ce=p(()=>s("h3",{class:"text-xl font-semibold mb-4"},"Clients List",-1)),we={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ye=["src","alt"],_e={class:"text-lg font-bold"},Ee={class:"text-gray-500 text-sm"},xe={class:"text-gray-500 text-sm"},Ve=["onClick"],Me={key:3,class:"mt-10 text-gray-500"};function ke(o,r,t,m,e,l){const n=f("input-text"),g=f("select-option"),_=f("router-link");return u(),d("div",A,[e.loading?(u(),d("div",q,z)):e.error?(u(),d("div",j,[b(h(e.error)+" ",1),e.debugInfo?(u(),d("div",T,[O,s("pre",N,h(e.debugInfo),1)])):c("",!0)])):(u(),d("div",B,[s("div",D,[P,s("button",{onClick:r[0]||(r[0]=(...i)=>l.toggleAddClientForm&&l.toggleAddClientForm(...i)),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded"},h(e.showAddClientForm?"Cancel":"Add Client"),1)]),e.successMessage?(u(),d("div",H,h(e.successMessage),1)):c("",!0),e.showAddClientForm?(u(),d("div",J,[s("h3",R,h(e.newClient.isUpdating?"Edit Client":"Add New Client"),1),s("form",{onSubmit:r[26]||(r[26]=M(i=>e.newClient.isUpdating?l.updateClient():l.addClient(),["prevent"])),enctype:"multipart/form-data"},[Object.keys(e.validationErrors).length>0?(u(),d("div",Y,[s("div",W,[s("ul",Z,[(u(!0),d(w,null,y(e.validationErrors,(i,C)=>(u(),d("li",{class:"text-red-500 text-xs italic",key:C},h(i[0]),1))),128))])])])):c("",!0),s("div",G,[K,s("input",{type:"file",onChange:r[1]||(r[1]=i=>l.onFileChange(i,"avatar")),accept:"image/*",required:!e.newClient.isUpdating,class:"mt-2 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,40,Q),e.validationErrors.avatar?(u(),d("p",X,h(e.validationErrors.avatar),1)):c("",!0),e.preview?(u(),d("div",$,[s("img",{src:e.preview,alt:"Image Preview",class:"w-48 h-48 object-cover rounded-md shadow-lg"},null,8,ee)])):c("",!0)]),s("div",re,[ie,s("input",{type:"file",onChange:r[2]||(r[2]=i=>l.onMultipleFileChange(i)),accept:"image/*",multiple:"",class:"mt-2 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"},null,32),e.validationErrors.additional_images?(u(),d("p",se,h(e.validationErrors.additional_images),1)):c("",!0)]),s("div",te,[a(n,{label:"Name",modelValue:e.newClient.name,"onUpdate:modelValue":r[3]||(r[3]=i=>e.newClient.name=i),required:!0,error:!!e.validationErrors.name,errorMessage:e.validationErrors.name},null,8,["modelValue","error","errorMessage"]),a(n,{label:"Email",modelValue:e.newClient.email,"onUpdate:modelValue":r[4]||(r[4]=i=>e.newClient.email=i),required:!0,error:!!e.validationErrors.email,errorMessage:e.validationErrors.email},null,8,["modelValue","error","errorMessage"])]),s("div",oe,[a(n,{label:"Age",modelValue:e.newClient.age,"onUpdate:modelValue":r[5]||(r[5]=i=>e.newClient.age=i),type:"number",required:!0,error:!!e.validationErrors.age,errorMessage:e.validationErrors.age,min:"18",max:"100"},null,8,["modelValue","error","errorMessage"]),a(n,{label:"Hair Color",modelValue:e.newClient.hairColor,"onUpdate:modelValue":r[6]||(r[6]=i=>e.newClient.hairColor=i),required:!0,error:!!e.validationErrors.hairColor,errorMessage:e.validationErrors.hairColor,maxlength:"50"},null,8,["modelValue","error","errorMessage"])]),s("div",le,[a(g,{label:"Body Type",options:e.bodyTypes,modelValue:e.newClient.bodytype,"onUpdate:modelValue":r[7]||(r[7]=i=>e.newClient.bodytype=i),required:!0,error:!!e.validationErrors.bodytype,errorMessage:e.validationErrors.bodytype},null,8,["options","modelValue","error","errorMessage"]),s("div",ne,[a(n,{label:"Height (Feet)",modelValue:e.newClient.heightFeet,"onUpdate:modelValue":r[8]||(r[8]=i=>e.newClient.heightFeet=i),type:"number",required:!0,error:!!e.validationErrors.heightFeet,errorMessage:e.validationErrors.heightFeet,min:"1",max:"8"},null,8,["modelValue","error","errorMessage"]),a(n,{label:"Inches",modelValue:e.newClient.heightInches,"onUpdate:modelValue":r[9]||(r[9]=i=>e.newClient.heightInches=i),type:"number",required:!0,error:!!e.validationErrors.heightInches,errorMessage:e.validationErrors.heightInches,min:"0",max:"11"},null,8,["modelValue","error","errorMessage"])])]),s("div",ae,[a(n,{label:"City",modelValue:e.newClient.city,"onUpdate:modelValue":r[10]||(r[10]=i=>e.newClient.city=i),required:!0,error:!!e.validationErrors.city,errorMessage:e.validationErrors.city},null,8,["modelValue","error","errorMessage"]),a(n,{label:"State",modelValue:e.newClient.state,"onUpdate:modelValue":r[11]||(r[11]=i=>e.newClient.state=i),required:!0,error:!!e.validationErrors.state,errorMessage:e.validationErrors.state},null,8,["modelValue","error","errorMessage"])]),s("div",de,[a(g,{label:"Country",options:e.countries,modelValue:e.newClient.country,"onUpdate:modelValue":r[12]||(r[12]=i=>e.newClient.country=i),required:!0,error:!!e.validationErrors.country,errorMessage:e.validationErrors.country},null,8,["options","modelValue","error","errorMessage"]),a(n,{label:"Current Location (City)",modelValue:e.newClient.currentLocation,"onUpdate:modelValue":r[13]||(r[13]=i=>e.newClient.currentLocation=i),required:!0,error:!!e.validationErrors.currentLocation,errorMessage:e.validationErrors.currentLocation},null,8,["modelValue","error","errorMessage"])]),s("div",ue,[a(g,{label:"Marital Status",options:e.maritalStatuses,modelValue:e.newClient.maritalStatus,"onUpdate:modelValue":r[14]||(r[14]=i=>e.newClient.maritalStatus=i),required:!0,error:!!e.validationErrors.maritalStatus,errorMessage:e.validationErrors.maritalStatus},null,8,["options","modelValue","error","errorMessage"]),a(g,{label:"Children",options:e.childrenOptions,modelValue:e.newClient.children,"onUpdate:modelValue":r[15]||(r[15]=i=>e.newClient.children=i),required:!0,error:!!e.validationErrors.children,errorMessage:e.validationErrors.children},null,8,["options","modelValue","error","errorMessage"])]),s("div",ge,[a(g,{label:"Religion",options:e.religions,modelValue:e.newClient.religion,"onUpdate:modelValue":r[16]||(r[16]=i=>e.newClient.religion=i),required:!0,error:!!e.validationErrors.religion,errorMessage:e.validationErrors.religion},null,8,["options","modelValue","error","errorMessage"]),a(g,{label:"Smoker",options:e.yesNoOptions,modelValue:e.newClient.smoker,"onUpdate:modelValue":r[17]||(r[17]=i=>e.newClient.smoker=i),required:!0,error:!!e.validationErrors.smoker,errorMessage:e.validationErrors.smoker},null,8,["options","modelValue","error","errorMessage"])]),s("div",me,[a(g,{label:"Drinker",options:e.drinkerOptions,modelValue:e.newClient.drinker,"onUpdate:modelValue":r[18]||(r[18]=i=>e.newClient.drinker=i),required:!0,error:!!e.validationErrors.drinker,errorMessage:e.validationErrors.drinker},null,8,["options","modelValue","error","errorMessage"]),a(g,{label:"English Level",options:e.englishLevels,modelValue:e.newClient.englishLevel,"onUpdate:modelValue":r[19]||(r[19]=i=>e.newClient.englishLevel=i),required:!0,error:!!e.validationErrors.englishLevel,errorMessage:e.validationErrors.englishLevel},null,8,["options","modelValue","error","errorMessage"])]),s("div",he,[a(n,{label:"Languages",modelValue:e.newClient.languages,"onUpdate:modelValue":r[20]||(r[20]=i=>e.newClient.languages=i),required:!0,error:!!e.validationErrors.languages,errorMessage:e.validationErrors.languages,maxlength:"100"},null,8,["modelValue","error","errorMessage"]),a(n,{label:"Interests",modelValue:e.newClient.interests,"onUpdate:modelValue":r[21]||(r[21]=i=>e.newClient.interests=i),required:!0,error:!!e.validationErrors.interests,errorMessage:e.validationErrors.interests,maxlength:"500"},null,8,["modelValue","error","errorMessage"])]),s("div",ce,[a(n,{label:"Education",modelValue:e.newClient.education,"onUpdate:modelValue":r[22]||(r[22]=i=>e.newClient.education=i),required:!0,error:!!e.validationErrors.education,errorMessage:e.validationErrors.education,maxlength:"100"},null,8,["modelValue","error","errorMessage"]),a(n,{label:"Job Title",modelValue:e.newClient.jobTitle,"onUpdate:modelValue":r[23]||(r[23]=i=>e.newClient.jobTitle=i),required:!0,error:!!e.validationErrors.jobTitle,errorMessage:e.validationErrors.jobTitle,maxlength:"100"},null,8,["modelValue","error","errorMessage"])]),s("div",pe,[a(n,{label:"Sports",modelValue:e.newClient.sports,"onUpdate:modelValue":r[24]||(r[24]=i=>e.newClient.sports=i),required:!0,error:!!e.validationErrors.sports,errorMessage:e.validationErrors.sports,maxlength:"100"},null,8,["modelValue","error","errorMessage"]),a(n,{label:"Hobbies",modelValue:e.newClient.hobbies,"onUpdate:modelValue":r[25]||(r[25]=i=>e.newClient.hobbies=i),required:!0,error:!!e.validationErrors.hobbies,errorMessage:e.validationErrors.hobbies,maxlength:"100"},null,8,["modelValue","error","errorMessage"])]),s("div",ve,[s("button",{class:"bg-connectyed-button-light hover:bg-connectyed-button-hover-light text-connectyed-button-hover-light hover:text-connectyed-button-hover-dark py-2 px-4 rounded",type:"submit",disabled:e.processing},h(e.processing?"Please wait":e.newClient.isUpdating?"Update":"Save"),9,fe)])],32)])):c("",!0),e.clients.length>0?(u(),d("div",be,[Ce,s("div",we,[(u(!0),d(w,null,y(e.clients,i=>(u(),d("div",{key:i.id,class:"p-4 bg-gray-100 rounded-lg shadow-md flex items-start"},[s("img",{src:l.getImageUrl(i.thumbnail_image),alt:i.user.name,class:"w-24 h-24 rounded-full object-cover mr-4"},null,8,ye),s("div",null,[s("h4",_e,[a(_,{to:"/"+i.user.username},{default:k(()=>[b(h(i.user.name),1)]),_:2},1032,["to"])]),s("p",Ee,"Age: "+h(i.age),1),s("p",xe," Location: "+h(i.city)+", "+h(i.state)+", "+h(i.country),1),s("p",{class:"text-orange-500 text-sm py-2 cursor-pointer",onClick:C=>l.editClient(i.id)}," Edit ",8,Ve)])]))),128))])])):(u(),d("div",Me,"No clients added yet."))]))])}const Se=V(S,[["render",ke],["__scopeId","data-v-190b4678"]]);export{Se as default};
